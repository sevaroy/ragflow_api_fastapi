# ğŸš€ RAGFlow API FastAPI ä½¿ç”¨æŒ‡å—

## ğŸ¯ å¿«é€Ÿé–‹å§‹

### 1. **åŸºç¤èŠå¤©åŠŸèƒ½**
```bash
# 1. å•Ÿå‹•å¾Œç«¯æœå‹™
python3 fastapi_server.py

# 2. å•Ÿå‹•èŠå¤©ç•Œé¢
streamlit run streamlit_app.py --server.port 8501

# 3. è¨ªå• http://localhost:8501
```

### 2. **RAG è©•ä¼°ç³»çµ±** â­ (æ¨è–¦)
```bash
# 1. è¨­ç½® OpenAI API Key (å¯é¸ï¼Œä½†æ¨è–¦)
export OPENAI_API_KEY="your-openai-api-key"

# 2. å•Ÿå‹•è©•ä¼°ç³»çµ±
streamlit run rag_evaluation.py --server.port 8502

# 3. è¨ªå• http://localhost:8502
```

### 3. **è©•ä¼°çµæœåˆ†æ**
```bash
# å•Ÿå‹•å„€è¡¨æ¿
streamlit run deepeval_dashboard.py --server.port 8503

# è¨ªå• http://localhost:8503
```

## ğŸ¨ æ‡‰ç”¨åŠŸèƒ½å°æ¯”

| æ‡‰ç”¨ | ç«¯å£ | ä¸»è¦åŠŸèƒ½ | æ¨è–¦ä½¿ç”¨å ´æ™¯ |
|------|------|----------|--------------|
| `streamlit_app.py` | 8501 | åŸºç¤èŠå¤©ç•Œé¢ | æ¸¬è©¦ RAG ç³»çµ±åŠŸèƒ½ |
| `rag_evaluation.py` | 8502 | **RAG è©•ä¼°ç³»çµ±** | **ç”Ÿç”¢ç’°å¢ƒè©•ä¼°** â­ |
| `deepeval_dashboard.py` | 8503 | çµæœåˆ†æå„€è¡¨æ¿ | è©•ä¼°çµæœè¦–è¦ºåŒ– |
| `fastapi_server.py` | 8000 | å¾Œç«¯ API æœå‹™ | æä¾› API æ¥å£ |

## ğŸ§ª RAG è©•ä¼°ç³»çµ±ä½¿ç”¨æ­¥é©Ÿ

### ğŸ“‹ å®Œæ•´è©•ä¼°æµç¨‹

1. **å•Ÿå‹•ç³»çµ±**:
```bash
streamlit run rag_evaluation.py --server.port 8502
```

2. **é…ç½®è©•ä¼°**:
   - ğŸ‘ˆ åœ¨å·¦å´é‚Šæ¬„é¸æ“‡æ•¸æ“šé›†
   - ğŸ¯ è¨­å®šæ¸¬è©¦å•é¡Œæ•¸é‡ (1-10)
   - ğŸ“Š èª¿æ•´è©•ä¼°é–¾å€¼ (å¯é¸)

3. **ç”Ÿæˆæ¸¬è©¦å•é¡Œ**:
   - ğŸ“ é»æ“Šã€Œç”Ÿæˆæ¸¬è©¦å•é¡Œã€
   - ğŸ” é è¦½ç”Ÿæˆçš„å•é¡Œ

4. **åŸ·è¡Œè©•ä¼°**:
   - ğŸ§ª é»æ“Šã€Œé–‹å§‹è©•ä¼°ã€
   - â³ ç­‰å¾…è©•ä¼°å®Œæˆ

5. **æŸ¥çœ‹çµæœ**:
   - ğŸ“Š æŸ¥çœ‹æ•´é«”çµ±è¨ˆ
   - ğŸ“‹ æŸ¥çœ‹è©³ç´°çµæœ
   - ğŸ’¾ å°å‡ºè©•ä¼°å ±å‘Š

### ğŸ”§ è©•ä¼°æ¨¡å¼

#### **çœŸå¯¦è©•ä¼°æ¨¡å¼** (æ¨è–¦)
```bash
# éœ€è¦ OpenAI API Key
export OPENAI_API_KEY="your-openai-api-key"
streamlit run rag_evaluation.py --server.port 8502
```

**ç‰¹è‰²:**
- ğŸ§ª ä½¿ç”¨çœŸå¯¦ DeepEval æŒ‡æ¨™
- ğŸ“Š Answer Relevancy, Faithfulness ç­‰
- ğŸ’¡ åŸºæ–¼çœŸå¯¦çµæœçš„æ”¹é€²å»ºè­°

#### **åŸºç¤è©•ä¼°æ¨¡å¼**
```bash
# ç„¡éœ€ OpenAI API Key
streamlit run rag_evaluation.py --server.port 8502
```

**ç‰¹è‰²:**
- ğŸ“Š åŸºç¤ç›¸é—œæ€§è©•ä¼°
- ğŸ” å›ç­”è³ªé‡åˆ†æ
- ğŸ“ˆ ä¸Šä¸‹æ–‡åŒ¹é…åº¦

## ğŸ“Š è©•ä¼°æŒ‡æ¨™èªªæ˜

### ğŸ§ª çœŸå¯¦ DeepEval æŒ‡æ¨™
- **Answer Relevancy**: å›ç­”èˆ‡å•é¡Œçš„ç›¸é—œæ€§ (0-1, è¶Šé«˜è¶Šå¥½)
- **Faithfulness**: å›ç­”å°æª¢ç´¢å…§å®¹çš„å¿ å¯¦åº¦ (0-1, è¶Šé«˜è¶Šå¥½)
- **Contextual Precision**: æª¢ç´¢å…§å®¹çš„ç²¾ç¢ºåº¦ (0-1, è¶Šé«˜è¶Šå¥½)
- **Contextual Recall**: æª¢ç´¢å…§å®¹çš„å®Œæ•´æ€§ (0-1, è¶Šé«˜è¶Šå¥½)
- **Hallucination**: è™›å‡ä¿¡æ¯æª¢æ¸¬ (0-1, è¶Šä½è¶Šå¥½)
- **Bias**: åè¦‹æª¢æ¸¬ (0-1, è¶Šä½è¶Šå¥½)

### ğŸ“ˆ è©•ä¼°é–¾å€¼å»ºè­°

| æŒ‡æ¨™ | é–‹ç™¼éšæ®µ | ç”Ÿç”¢ç’°å¢ƒ | æ³•å¾‹å°ˆæ¥­ |
|------|----------|----------|----------|
| Answer Relevancy | â‰¥ 0.6 | â‰¥ 0.8 | â‰¥ 0.8 |
| Faithfulness | â‰¥ 0.6 | â‰¥ 0.8 | â‰¥ 0.9 |
| Contextual Precision | â‰¥ 0.6 | â‰¥ 0.8 | â‰¥ 0.8 |
| Contextual Recall | â‰¥ 0.6 | â‰¥ 0.7 | â‰¥ 0.7 |
| Hallucination | â‰¤ 0.4 | â‰¤ 0.2 | â‰¤ 0.1 |
| Bias | â‰¤ 0.6 | â‰¤ 0.3 | â‰¤ 0.2 |

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œè§£æ±º

1. **æ¨¡çµ„å°å…¥éŒ¯èª¤**:
```bash
# ç¢ºä¿åœ¨è™›æ“¬ç’°å¢ƒä¸­
source venv/bin/activate
pip install -r requirements.txt
```

2. **ç«¯å£è¡çª**:
```bash
# ä½¿ç”¨ä¸åŒç«¯å£
streamlit run rag_evaluation.py --server.port 8504
```

3. **API é€£æ¥å¤±æ•—**:
```bash
# æª¢æŸ¥å¾Œç«¯æœå‹™
python3 fastapi_server.py
curl http://localhost:8000/
```

4. **OpenAI API å•é¡Œ**:
```bash
# æª¢æŸ¥ API Key
echo $OPENAI_API_KEY

# æ¸¬è©¦ API é€£æ¥
python3 -c "import openai; print('API Key æœ‰æ•ˆ')"
```

## ğŸ“ é …ç›®çµæ§‹

```
ragflow_api_fastapi/
â”œâ”€â”€ ğŸš€ æ ¸å¿ƒæ‡‰ç”¨
â”‚   â”œâ”€â”€ fastapi_server.py          # å¾Œç«¯æœå‹™
â”‚   â”œâ”€â”€ streamlit_app.py           # èŠå¤©ç•Œé¢
â”‚   â”œâ”€â”€ rag_evaluation.py          # è©•ä¼°ç³»çµ± â­
â”‚   â””â”€â”€ deepeval_dashboard.py      # çµæœå„€è¡¨æ¿
â”œâ”€â”€ ğŸ”§ æ ¸å¿ƒæ¨¡çµ„
â”‚   â”œâ”€â”€ ragflow_chatbot.py         # RAGFlow å®¢æˆ¶ç«¯
â”‚   â”œâ”€â”€ deepeval_integration.py    # DeepEval æ•´åˆ
â”‚   â””â”€â”€ config.py                  # é…ç½®ç®¡ç†
â”œâ”€â”€ ğŸ§ª test/                       # æ¸¬è©¦æ–‡ä»¶
â”œâ”€â”€ ğŸ“š docs/                       # æ–‡æª”
â””â”€â”€ ğŸ“‹ é …ç›®æ–‡æª”
```

## ğŸ¯ æœ€ä½³å¯¦è¸

### ğŸ¥‡ æ¨è–¦å·¥ä½œæµç¨‹

1. **é–‹ç™¼éšæ®µ**:
```bash
# 1. åŸºç¤åŠŸèƒ½æ¸¬è©¦
streamlit run streamlit_app.py --server.port 8501

# 2. è©•ä¼°ç³»çµ±æ¸¬è©¦
streamlit run rag_evaluation.py --server.port 8502
```

2. **ç”Ÿç”¢ç’°å¢ƒ**:
```bash
# 1. è¨­ç½® API Key
export OPENAI_API_KEY="your-api-key"

# 2. åŸ·è¡Œå®Œæ•´è©•ä¼°
streamlit run rag_evaluation.py --server.port 8502

# 3. åˆ†æè©•ä¼°çµæœ
streamlit run deepeval_dashboard.py --server.port 8503
```

### ğŸ“Š è©•ä¼°å»ºè­°

- **æ¸¬è©¦å•é¡Œæ•¸é‡**: é–‹ç™¼éšæ®µ 3-5 å€‹ï¼Œç”Ÿç”¢ç’°å¢ƒ 10-20 å€‹
- **è©•ä¼°é »ç‡**: æ¯æ¬¡æ¨¡å‹æ›´æ–°å¾Œé€²è¡Œè©•ä¼°
- **é–¾å€¼èª¿æ•´**: æ ¹æ“šæ¥­å‹™éœ€æ±‚èª¿æ•´è©•ä¼°æ¨™æº–
- **çµæœåˆ†æ**: é‡é»é—œæ³¨å¤±æ•—æ¡ˆä¾‹çš„æ”¹é€²å»ºè­°

## ğŸ† ç¸½çµ

**RAG è©•ä¼°ç³»çµ±** (`rag_evaluation.py`) æ˜¯é …ç›®çš„æ ¸å¿ƒåŠŸèƒ½ï¼š

- âœ… **åŠŸèƒ½å®Œæ•´**: å•é¡Œç”Ÿæˆ â†’ è©•ä¼°åŸ·è¡Œ â†’ çµæœåˆ†æ
- âœ… **ç•Œé¢å‹å¥½**: å´é‚Šæ¬„æ§åˆ¶ + ä¸»é é¢å±•ç¤º
- âœ… **é›™æ¨¡å¼æ”¯æŒ**: æœ‰/ç„¡ OpenAI API Key éƒ½èƒ½é‹è¡Œ
- âœ… **éŒ¯èª¤è™•ç†**: å®Œå–„çš„ç•°å¸¸è™•ç†æ©Ÿåˆ¶
- âœ… **å°ˆæ¥­è©•ä¼°**: ä½¿ç”¨çœŸå¯¦ DeepEval æŒ‡æ¨™

**ç«‹å³é–‹å§‹ä½¿ç”¨:**
```bash
streamlit run rag_evaluation.py --server.port 8502
```

**è¨ªå•åœ°å€:**
```
http://localhost:8502
```

ğŸ‰ **ç¾åœ¨ä½ æœ‰ä¸€å€‹å®Œæ•´ã€ç©©å®šã€å°ˆæ¥­çš„ RAG è©•ä¼°ç³»çµ±äº†ï¼**